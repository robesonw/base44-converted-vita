import jwt from 'jsonwebtoken';\nimport { Request, Response, NextFunction } from 'express';\n\nexport const authMiddleware = (req: Request, res: Response, next: NextFunction) => {\n  const token = req.headers.authorization?.split(' ')[1];\n  if (!token) return res.status(401).send('Unauthorized');\n\n  jwt.verify(token, process.env.JWT_SECRET || '', (err, user) => {\n    if (err) return res.status(403).send('Forbidden');\n    req.user = user;\n    next();\n  });\n};